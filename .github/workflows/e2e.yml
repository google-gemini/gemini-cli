name: 'Testing: Flaky Test'

on:
  push:
  workflow_dispatch:

jobs:
  flaky_test:
    name: 'Run Flaky Test 100 times'
    runs-on: 'ubuntu-latest'
    steps:
      - name: 'Checkout'
        uses: 'actions/checkout@v4'

      - name: 'Set up Node.js'
        uses: 'actions/setup-node@v4'
        with:
          node-version: '20.x'

      - name: 'Install dependencies'
        run: 'npm ci'

      - name: 'Build project'
        run: 'npm run build'

      - name: 'Run test 100 times'
        shell: 'bash'
        run: |
          for i in {1..100}; do
            echo "Run #$i"
            npm run test packages/cli/src/ui/components/shared/BaseSelectionList.test.tsx || exit 1
          done
